<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital-Marketing - Produits Numériques Madagascar</title>
    <style>
        /* Styles CSS existants et nouveaux styles pour les formulaires et la page de détails */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            overflow-x: hidden;
        }

        /* En-tête */
        .header {
            background: white;
            border-bottom: 1px solid #e0e0e0;
            padding: 12px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            font-size: 32px;
            font-weight: bold;
            background: linear-gradient(45deg, #228B22, #DC143C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .search-container {
            flex: 1;
            max-width: 600px;
            margin: 0 40px;
            position: relative;
        }

        .search-bar {
            width: 100%;
            padding: 12px 50px 12px 20px;
            border: 2px solid #228B22;
            border-radius: 30px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s;
        }

        .search-bar:focus {
            border-color: #DC143C;
            box-shadow: 0 0 10px rgba(220, 20, 60, 0.2);
        }

        .search-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: #ff6b35;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: all 0.3s;
        }

        .search-btn:hover {
            background: #DC143C;
            transform: translateY(-50%) scale(1.1);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .btn-header {
            padding: 8px 16px;
            border: 1px solid #228B22;
            background: white;
            color: #228B22;
            border-radius: 20px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-header:hover {
            background: #228B22;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(34, 139, 34, 0.3);
        }
        
        .btn-sell { /* Nouveau style pour le bouton "Vendre" */
            background: #DC143C;
            color: white;
            border-color: #DC143C;
        }

        .btn-sell:hover {
            background: #b8122e;
            box-shadow: 0 4px 10px rgba(220, 20, 60, 0.3);
        }

        .flag-mg {
            width: 32px;
            height: 24px;
            border-radius: 4px;
            border: 1px solid #ddd;
            background-image: url('https://flagcdn.com/32x24/mg.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .flag-mg:hover {
            transform: scale(1.1);
        }

        .cart-icon {
            position: relative;
            font-size: 24px;
            color: #333;
            cursor: pointer;
            transition: all 0.3s;
        }

        .cart-icon:hover {
            color: #228B22;
            transform: scale(1.1);
        }

        /* Menu Mobile */
        .mobile-menu {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        .mobile-menu:hover {
            background-color: #f0f0f0;
        }

        .mobile-menu span {
            width: 25px;
            height: 3px;
            background: #333;
            margin: 3px 0;
            border-radius: 2px;
            transition: all 0.3s;
        }

        .mobile-menu.active span:nth-child(1) {
            transform: rotate(45deg) translate(9px, 9px);
        }

        .mobile-menu.active span:nth-child(2) {
            opacity: 0;
        }

        .mobile-menu.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }

        /* Navigation */
        .nav {
            background: white;
            border-bottom: 1px solid #e0e0e0;
            padding: 0 20px;
            transition: all 0.3s;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 40px;
            padding: 15px 0;
        }

        .nav-link {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            padding: 8px 0;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
            position: relative;
            cursor: pointer;
        }

        .nav-link:hover, .nav-link.active {
            color: #228B22;
            border-bottom-color: #228B22;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -2px;
            left: 50%;
            background: #DC143C;
            transition: all 0.3s;
            transform: translateX(-50%);
        }

        .nav-link:hover::after {
            width: 100%;
        }

        /* Navigation Mobile */
        .mobile-nav {
            display: none;
            position: fixed;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #228B22 0%, #DC143C 100%);
            z-index: 2000;
            transition: left 0.4s ease-in-out;
            padding-top: 80px;
            overflow-y: auto;
        }

        .mobile-nav.active {
            left: 0;
        }

        .mobile-nav-container {
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .mobile-nav-link {
            display: block;
            color: white;
            text-decoration: none;
            font-size: 18px;
            font-weight: 500;
            padding: 15px 20px;
            margin: 5px 0;
            border-radius: 10px;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            text-align: left;
            width: 100%;
            box-sizing: border-box;
            cursor: pointer;
        }

        .mobile-nav-link:hover {
            background: rgba(255,255,255,0.2);
            transform: translateX(10px);
        }

        .mobile-nav-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 30px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .mobile-nav-close:hover {
            background: rgba(255,255,255,0.2);
            transform: rotate(90deg);
        }

        /* Contenu Principal */
        .main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Masquer toutes les sections principales par défaut */
        .main > section {
            display: none;
        }
        
        /* Afficher la section active */
        .main > section.active {
            display: block;
        }

        .hero-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .hero-title {
            font-size: 36px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .hero-subtitle {
            color: #666;
            font-size: 18px;
            margin-bottom: 30px;
        }

        /* Résultats de recherche */
        .search-results {
            background: #e8f5e8;
            border: 1px solid #228B22;
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: none;
        }

        .search-results.active {
            display: block;
        }

        .search-results-text {
            color: #228B22;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .search-results-count {
            color: #666;
            font-size: 14px;
        }

        .no-results {
            background: #ffe6e6;
            border: 1px solid #DC143C;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            display: none;
        }

        .no-results.active {
            display: block;
        }

        .no-results-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .no-results-title {
            color: #DC143C;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .no-results-text {
            color: #666;
            margin-bottom: 20px;
        }

        .clear-search-btn {
            background: #DC143C;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .clear-search-btn:hover {
            background: #b8122e;
            transform: translateY(-2px);
        }

        /* Filtres */
        .filters {
            display: none; /* Masqué par défaut, géré par JS */
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 40px;
            align-items: center;
        }

        .filters.active {
            display: flex;
        }

        .filter-btn {
            padding: 10px 18px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
        }

        .filter-btn:hover, .filter-btn.active {
            background: #228B22;
            color: white;
            border-color: #228B22;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(34, 139, 34, 0.3);
        }

        .filter-btn.top-seller {
            background: #DC143C;
            color: white;
            border-color: #DC143C;
        }

        .filter-btn.top-seller:hover {
            background: #b8122e;
        }

        /* Grille des produits */
        .products-grid {
            display: none;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 60px;
            transition: all 0.3s;
        }

        .products-grid.active {
            display: grid;
        }

        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .product-card.hidden {
            display: none;
        }

        .product-image {
            width: 100%;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .product-card:hover .product-image img {
            transform: scale(1.05);
        }

        /* Arrière-plans de secours si l'image ne se charge pas */
        .product-image.canva { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .product-image.ebook { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
        .product-image.formation { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); }
        .product-image.calendar { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .product-image.coaching { background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%); }
        .product-image.webdesign { background: linear-gradient(135deg, #2af598 0%, #009efd 100%); }
        .product-image.logistique { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }

        .product-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #DC143C;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            animation: pulse 2s infinite;
            z-index: 10;
        }
        /* Nouveau badge pour les produits récemment ajoutés */
        .product-badge.new-badge {
            background: #228B22; /* Vert pour "Nouveau" */
        }


        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .product-info {
            padding: 20px;
        }

        .product-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .product-category {
            font-size: 12px;
            color: #228B22;
            background: rgba(34, 139, 34, 0.1);
            padding: 2px 8px;
            border-radius: 10px;
            display: inline-block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .stars {
            color: #ffc107;
            font-size: 14px;
        }

        .rating-count {
            color: #666;
            font-size: 14px;
        }

        .product-price {
            font-size: 20px;
            font-weight: bold;
            color: #228B22;
            margin-bottom: 8px;
        }

        .old-price {
            color: #999;
            text-decoration: line-through;
            font-size: 16px;
            margin-left: 8px;
        }

        .discount {
            background: #DC143C;
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 12px;
            margin-left: 8px;
        }
        .product-badge.discount-badge { /* Specific style for discount badge if needed */
            background: #DC143C;
        }


        .product-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .download-btn {
            flex: 1;
            background: #228B22;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .download-btn:hover {
            background: #1e7a1e;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(34, 139, 34, 0.3);
        }

        .download-btn.premium {
            background: #DC143C;
        }

        .download-btn.premium:hover {
            background: #b8122e;
        }

        .preview-btn {
            background: white;
            color: #228B22;
            border: 1px solid #228B22;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .preview-btn:hover {
            background: #228B22;
            color: white;
        }

        .product-status {
            font-size: 12px;
            margin-top: 8px;
            padding: 4px 8px;
            border-radius: 10px;
            display: inline-block;
            font-weight: 500;
        }

        .product-status.free {
            background: #e8f5e8;
            color: #228B22;
        }

        .product-status.premium {
            background: #ffe6e6;
            color: #DC143C;
        }

        .product-status.login-required {
            background: #fff3cd;
            color: #856404;
        }
        
        /* Styles pour les sections de formulaire et de détails */
        .form-section, .product-detail-section {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 20px auto;
        }

        .form-title, .detail-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 25px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="password"],
        .form-group input[type="number"],
        .form-group input[type="file"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #228B22;
            box-shadow: 0 0 8px rgba(34, 139, 34, 0.2);
        }

        .form-actions {
            text-align: center;
            margin-top: 30px;
        }

        .form-submit-btn {
            background: #228B22;
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .form-submit-btn:hover {
            background: #1e7a1e;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(34, 139, 34, 0.3);
        }

        /* Styles pour la page de détail */
        .product-detail-content {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
        }

        .product-detail-image-container {
            flex: 1;
            min-width: 300px;
            height: 350px;
            background: #f0f0f0;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .product-detail-image-container img, .product-detail-image-container video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-detail-info {
            flex: 1;
        }

        .detail-category {
            font-size: 14px;
            color: #228B22;
            background: rgba(34, 139, 34, 0.1);
            padding: 4px 10px;
            border-radius: 12px;
            display: inline-block;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .detail-seller {
            color: #666;
            margin-bottom: 15px;
        }

        .detail-price {
            font-size: 28px;
            font-weight: bold;
            color: #228B22;
            margin-bottom: 20px;
        }

        .detail-actions {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
        }
        
        .detail-like-btn {
            background: white;
            border: 1px solid #DC143C;
            color: #DC143C;
            width: 50px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            transition: all 0.3s;
        }

        .detail-like-btn:hover {
            background: #DC143C;
            color: white;
        }

        .detail-description {
            line-height: 1.7;
            color: #555;
        }

        /* Section des commentaires */
        .comments-section {
            margin-top: 40px;
            border-top: 1px solid #eee;
            padding-top: 30px;
        }

        .comments-section h4 {
            font-size: 18px;
            margin-bottom: 20px;
        }
        
        #commentsList .comment-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        #commentsList .comment-author {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        #commentsList .comment-text {
            color: #666;
        }
        
        .comment-form {
            margin-top: 20px;
        }
        
        .comment-form h5 {
            margin-bottom: 10px;
        }

        .comment-form textarea {
            width: 100%;
            height: 80px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-bottom: 10px;
        }
        
        .comment-form button {
            background: #228B22;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .comment-form button:hover {
            background: #1e7a1e;
        }


        /* Indicateur de chargement */
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #228B22;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Section Newsletter */
        .newsletter-section {
            background: linear-gradient(135deg, #228B22 0%, #DC143C 100%);
            color: white;
            padding: 60px 20px;
            margin: 40px 0;
            border-radius: 16px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .newsletter-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .newsletter-container {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .newsletter-title {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 16px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .newsletter-subtitle {
            font-size: 18px;
            margin-bottom: 30px;
            opacity: 0.9;
            line-height: 1.5;
        }

        .newsletter-form {
            display: flex;
            gap: 12px;
            max-width: 400px;
            margin: 0 auto;
            flex-wrap: wrap;
        }

        .newsletter-input {
            flex: 1;
            min-width: 200px;
            padding: 14px 20px;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            outline: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .newsletter-input:focus {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .newsletter-btn {
            padding: 14px 30px;
            background: white;
            color: #228B22;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .newsletter-btn:hover {
            background: #f8f9fa;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        /* Pied de page */
        .footer {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 60px 20px 20px;
            width: 100%;
        }

        .footer-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-section h3 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #228B22;
        }

        .footer-section p {
            color: #bdc3c7;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 10px;
        }

        .footer-section a {
            color: #bdc3c7;
            text-decoration: none;
            transition: color 0.3s;
            cursor: pointer;
        }

        .footer-section a:hover {
            color: #228B22;
        }

        .social-icons {
            display: flex;
            gap: 15px;
        }

        .social-icon {
            width: 40px;
            height: 40px;
            background: #34495e;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .social-icon:hover {
            background: #228B22;
            transform: translateY(-2px);
        }

        .footer-bottom {
            border-top: 1px solid #34495e;
            padding-top: 20px;
            text-align: center;
            color: #bdc3c7;
        }

        .footer-bottom .heart {
            color: #DC143C;
            animation: heartbeat 1.5s ease-in-out infinite;
        }

        @keyframes heartbeat {
            0% { transform: scale(1); }
            14% { transform: scale(1.2); }
            28% { transform: scale(1); }
            42% { transform: scale(1.2); }
            70% { transform: scale(1); }
        }

        /* NOUVEAUX STYLES : MODALE D'AUTHENTIFICATION */
        .auth-modal {
            display: none; /* Caché par défaut */
            position: fixed;
            z-index: 3000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
        }

        .auth-modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 30px;
            border: 1px solid #888;
            width: 90%;
            max-width: 450px;
            border-radius: 12px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.2);
            position: relative;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .auth-modal .close-btn {
            color: #aaa;
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .auth-modal .close-btn:hover,
        .auth-modal .close-btn:focus {
            color: #000;
        }
        
        .auth-modal h2 {
            text-align: center;
            margin-bottom: 25px;
        }

        .google-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            padding: 12px;
            border-radius: 25px;
            border: 1px solid #ddd;
            background: white;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }
        
        .google-btn:hover {
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .divider {
            text-align: center;
            margin: 20px 0;
            color: #999;
        }
        
        .auth-form-toggle {
            text-align: center;
            margin-top: 20px;
        }
        
        .auth-form-toggle a {
            color: #228B22;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
        }
        .auth-form-toggle a:hover {
            text-decoration: underline;
        }

        /* NOUVEAUX STYLES : Boutons d'édition/suppression */
        .product-owner-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .edit-btn, .delete-btn {
            flex: 1;
            padding: 8px 12px;
            border-radius: 6px;
            border: none;
            color: white;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .edit-btn {
            background-color: #ffc107; /* Jaune */
        }
        .edit-btn:hover {
            background-color: #e0a800;
        }
        
        .delete-btn {
            background-color: #DC143C; /* Rouge */
        }
        .delete-btn:hover {
            background-color: #b8122e;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-container {
                flex-wrap: wrap;
                gap: 15px;
            }

            .logo {
                font-size: 24px;
            }

            .search-container {
                order: 3;
                width: 100%;
                margin: 0;
            }

            .header-actions {
                gap: 10px;
            }

            .btn-header {
                padding: 6px 12px;
                font-size: 14px;
            }

            .mobile-menu {
                display: flex;
            }

            .nav {
                display: none;
            }

            .mobile-nav {
                display: block;
            }

            .hero-title {
                font-size: 28px;
            }

            .hero-subtitle {
                font-size: 16px;
            }

            .products-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 20px;
            }

            .filters {
                justify-content: center;
            }

            .filter-btn {
                font-size: 13px;
                padding: 8px 14px;
            }

            .newsletter-title {
                font-size: 24px;
            }

            .newsletter-subtitle {
                font-size: 16px;
            }

            .newsletter-form {
                flex-direction: column;
                align-items: center;
            }

            .newsletter-input {
                width: 100%;
                max-width: 300px;
            }

            .newsletter-btn {
                width: 100%;
                max-width: 200px;
            }

            .product-detail-image-container {
                max-width: 100%;
                height: 300px;
            }
            .auth-modal-content {
                margin: 20% auto;
            }
        }

        @media (max-width: 480px) {
            .products-grid {
                grid-template-columns: 1fr; /* Une seule colonne sur les très petits écrans pour une meilleure lisibilité */
                gap: 15px;
            }

            .product-card {
                font-size: 14px;
            }

            .product-info {
                padding: 15px;
            }

            .product-title {
                font-size: 14px;
            }

            .product-price {
                font-size: 18px;
            }

            .newsletter-section {
                padding: 40px 20px;
            }

            .newsletter-title {
                font-size: 20px;
            }

            .newsletter-subtitle {
                font-size: 14px;
            }

            .product-actions {
                flex-direction: column;
            }

            .download-btn, .preview-btn {
                width: 100%;
            }

            .form-section, .product-detail-section {
                padding: 20px;
            }

            .form-title, .detail-title {
                font-size: 22px;
            }

            .product-detail-content {
                flex-direction: column;
            }

            .product-detail-image-container {
                min-width: unset;
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <div class="logo">SmartDigitalPro</div>
            
            <div class="search-container">
                <input type="text" class="search-bar" id="searchInput" placeholder="Rechercher des produits numériques...">
                <button class="search-btn">🔍</button>
            </div>
            
            <div class="header-actions">
                <a href="#" class="btn-header btn-sell" data-action="sell">Vendre</a>
                <div id="auth-links">
                    <a href="#" class="btn-header" data-action="login">Se connecter</a>
                    <a href="#" class="btn-header" data-action="register">S'inscrire</a>
                </div>
                <div id="user-profile" style="display: none;">
                    <span id="username-display" style="font-weight: 500; margin-right: 10px;"></span>
                    <a href="#" class="btn-header" data-action="logout">Déconnexion</a>
                </div>
                <div class="flag-mg"></div>
                <div class="cart-icon">🛒</div>
                <div class="mobile-menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </header>

    <nav class="nav">
        <div class="nav-container">
            <a class="nav-link" data-section="home">Accueil</a>
            <a class="nav-link" data-section="products">Produits</a>
            <a class="nav-link" data-section="formations">Formations</a>
            <a class="nav-link" data-section="services">Services</a>
            <a class="nav-link" data-section="blog">Blog</a>
            <a class="nav-link" data-section="contact">Contact</a>
        </div>
    </nav>

    <div class="mobile-nav">
        <div class="mobile-nav-close">×</div>
        <div class="mobile-nav-container">
            <a class="mobile-nav-link" data-section="home">🏠 Accueil</a>
            <a class="mobile-nav-link" data-action="sell">💰 Vendre un produit</a>
            <a class="mobile-nav-link" data-section="products">📦 Produits</a>
            <a class="mobile-nav-link" data-section="formations">🎓 Formations</a>
            <a class="mobile-nav-link" data-section="services">⚙️ Services</a>
            <a class="mobile-nav-link" data-section="blog">📝 Blog</a>
            <a class="mobile-nav-link" data-section="contact">📧 Contact</a>
        </div>
    </div>

    <main class="main">
        <section class="hero-section" id="home">
            <h1 class="hero-title" id="heroTitle">Les produits numériques les plus vendus</h1>
            <p class="hero-subtitle" id="heroSubtitle">1000+ résultats pertinents</p>
        </section>
        
        <section id="productsContainer">
            <div class="search-results" id="searchResults">
                <div class="search-results-text" id="searchResultsText"></div>
                <div class="search-results-count" id="searchResultsCount"></div>
            </div>

            <div class="no-results" id="noResults">
                <div class="no-results-icon">🔍</div>
                <div class="no-results-title">Aucun produit ne correspond à votre recherche</div>
                <div class="no-results-text">Essayez d'autres mots-clés ou parcourez nos catégories populaires.</div>
                <button class="clear-search-btn">Effacer la recherche</button>
            </div>

            <div class="loading-spinner" id="loadingSpinner">
                <div class="spinner"></div>
                <p>Recherche en cours...</p>
            </div>

            <div class="filters" id="filtersSection">
                <button class="filter-btn top-seller" data-filter="top-seller">Top vente</button>
                <button class="filter-btn" data-filter="all">Téléchargement numérique</button>
                <button class="filter-btn" data-filter="madagascar">Pays : Madagascar</button>
                <button class="filter-btn" data-filter="canva">Modèles Canva</button>
                <button class="filter-btn" data-filter="ebook">E-books</button>
                <button class="filter-btn" data-filter="formation">Formations vidéo</button>
                <button class="filter-btn" data-filter="coaching">Coaching</button>
            </div>

            <div class="products-grid" id="productsGridSection">
                </div>
        </section>

        <section class="form-section" id="sellProductForm">
            <h2 class="form-title">Proposer un nouveau produit ou service</h2>
            <form id="productPublishForm">
                <input type="hidden" id="editingProductId" value="">
                <div class="form-group">
                    <label for="productTitle">Titre du produit ou service :</label>
                    <input type="text" id="productTitle" name="productTitle" required>
                </div>
                <div class="form-group">
                    <label for="productCategory">Catégorie :</label>
                    <select id="productCategory" name="productCategory" required>
                        <option value="">Sélectionnez une catégorie</option>
                        <option value="canva">Modèles Canva</option>
                        <option value="ebook">E-books</option>
                        <option value="formation">Formations vidéo</option>
                        <option value="coaching">Coaching</option>
                        <option value="webdesign">Web Design</option>
                        <option value="logistique">Logistique</option>
                        <option value="other">Autres</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="productDescription">Description :</label>
                    <textarea id="productDescription" name="productDescription" rows="6" required></textarea>
                </div>
                <div class="form-group">
                    <label for="productFile">Image ou fichier à uploader (PDF, vidéo, zip, etc.) :</label>
                    <input type="file" id="productFile" name="productFile" accept=".pdf,.zip,.mp4,.jpg,.png,.gif">
                </div>
                <div class="form-group">
                    <label for="productPrice">Prix (MGA) :</label>
                    <input type="number" id="productPrice" name="productPrice" step="100" min="0" required>
                </div>
                <div class="form-group">
                    <label for="productPreview">Aperçu (URL ou fichier, optionnel) :</label>
                    <input type="text" id="productPreview" name="productPreview" placeholder="URL de l'aperçu ou uploader un fichier">
                    <input type="file" id="productPreviewFile" name="productPreviewFile" accept=".pdf,.mp4,.jpg,.png,.gif">
                </div>
                <div class="form-actions">
                    <button type="submit" class="form-submit-btn">Soumettre le produit</button>
                </div>
            </form>
        </section>

        <section class="form-section" id="downloadForm">
            <h2 class="form-title">Télécharger votre produit</h2>
            <p style="text-align: center; margin-bottom: 20px; color: #666;">Veuillez remplir vos informations pour accéder au téléchargement.</p>
            <form id="downloadInfoForm">
                <div class="form-group">
                    <label for="downloadName">Votre Nom :</label>
                    <input type="text" id="downloadName" name="downloadName" required>
                </div>
                <div class="form-group">
                    <label for="downloadEmail">Votre Email :</label>
                    <input type="email" id="downloadEmail" name="downloadEmail" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="form-submit-btn">Accéder au téléchargement</button>
                </div>
            </form>
        </section>

        <section class="product-detail-section" id="productDetail">
            <h2 class="detail-title" id="detailProductTitle">Titre du Produit Détaillé</h2>
            <div class="product-detail-content">
                <div class="product-detail-image-container" id="detailProductImage">
                    Aperçu du Produit
                </div>
                <div class="product-detail-info">
                    <div class="detail-category" id="detailProductCategory">Catégorie</div>
                    <p class="detail-seller">Vendu par : <span id="detailProductSeller">Nom du Vendeur</span></p>
                    <div class="detail-price" id="detailProductPrice">0 MGA</div>
                    <div class="detail-actions">
                        <button class="download-btn" id="detailDownloadBtn" data-action="download">Télécharger</button>
                        <button class="detail-like-btn" id="detailLikeBtn" data-action="like">❤️ <span id="likeCount">0</span></button>
                    </div>
                    <p class="detail-description" id="detailProductDescription">Description complète du produit/service.</p>
                </div>
            </div>
            <div class="comments-section">
                <h4>Commentaires (<span id="commentCount">0</span>)</h4>
                <div id="commentsList">
                    </div>
                <div class="comment-form" data-action="comment">
                    <h5>Laisser un commentaire :</h5>
                    <textarea id="newCommentText" placeholder="Écrivez votre commentaire ici..."></textarea>
                    <button id="submitCommentBtn">Soumettre</button>
                </div>
            </div>
        </section>

        <section class="newsletter-section" id="newsletterSection">
            <div class="newsletter-container">
                <h2 class="newsletter-title">Rejoignez notre Newsletter</h2>
                <p class="newsletter-subtitle">Recevez les dernières offres et astuces en marketing digital directement dans votre boîte de réception.</p>
                <form class="newsletter-form">
                    <input type="email" class="newsletter-input" placeholder="Votre adresse email" required>
                    <button type="submit" class="newsletter-btn">S'abonner</button>
                </form>
            </div>
        </section>
    </main>

    <div id="authModal" class="auth-modal">
        <div class="auth-modal-content">
            <span class="close-btn">&times;</span>

            <div id="loginForm">
                <h2>Se connecter</h2>
                <form>
                    <button type="button" class="google-btn">
                        <img src="https://www.google.com/favicon.ico" alt="Google icon" width="20" height="20">
                        Continuer avec Google
                    </button>
                    <div class="divider">ou</div>
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Mot de passe</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="form-submit-btn" data-action="login-submit">Se connecter</button>
                    </div>
                    <div class="auth-form-toggle">
                        <p>Pas encore de compte ? <a data-action="show-register">S'inscrire</a></p>
                    </div>
                </form>
            </div>

            <div id="registerForm" style="display:none;">
                <h2>Créer un compte</h2>
                <form>
                     <button type="button" class="google-btn">
                        <img src="https://www.google.com/favicon.ico" alt="Google icon" width="20" height="20">
                        S'inscrire avec Google
                    </button>
                    <div class="divider">ou</div>
                    <div class="form-group">
                        <label for="registerName">Nom complet</label>
                        <input type="text" id="registerName" required>
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">Email</label>
                        <input type="email" id="registerEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">Mot de passe</label>
                        <input type="password" id="registerPassword" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="form-submit-btn" data-action="register-submit">S'inscrire</button>
                    </div>
                    <div class="auth-form-toggle">
                        <p>Déjà un compte ? <a data-action="show-login">Se connecter</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>SmartDigitalPro</h3>
                    <p>Votre plateforme de référence pour les produits et services numériques à Madagascar. Boostez votre business avec nos solutions innovantes.</p>
                    <div class="social-icons">
                        <div class="social-icon">F</div>
                        <div class="social-icon">I</div>
                        <div class="social-icon">L</div>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Liens Rapides</h3>
                    <ul>
                        <li><a data-section="home">Accueil</a></li>
                        <li><a data-section="products">Produits</a></li>
                        <li><a data-section="formations">Formations</a></li>
                        <li><a data-section="services">Services</a></li>
                        <li><a data-section="blog">Blog</a></li>
                        <li><a data-section="newsletterSection">S'abonner</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Support</h3>
                    <ul>
                        <li><a href="#">FAQ</a></li>
                        <li><a href="#">Contactez-nous</a></li>
                        <li><a href="#">Politique de Confidentialité</a></li>
                        <li><a href="#">Conditions Générales</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact</h3>
                    <p>Antananarivo, Madagascar</p>
                    <p>Email: contact@smartdigitalpro.mg</p>
                    <p>Téléphone: +261 32 12 345 67</p>
                </div>
            </div>
            <div class="footer-bottom">
                &copy; 2024 SmartDigitalPro. Tous droits réservés. Fait avec <span class="heart">❤️</span> à Madagascar.
            </div>
        </div>
    </footer>

    <script type="module">
        // --- AUTHENTIFICATION SIMULÉE ---
        let authState = {
            isLoggedIn: false,
            currentUser: null // ex: { id: 'user1', name: 'Jean Dupont' }
        };
        
        const users = [
            { id: 'user1', name: 'Jean Dupont', email: 'jean@test.com', password: 'password123' }
        ];

        let products = [
            {
                id: 'product1',
                creatorId: 'user1',
                title: '100 modèles Canva pour les réseaux sociaux',
                category: 'Modèles Canva',
                categorySlug: 'canva',
                description: 'Un pack complet de 100 modèles Canva professionnels et personnalisables pour dynamiser votre présence sur les réseaux sociaux. Idéal pour Instagram, Facebook, et plus encore. Gagnez du temps et créez du contenu percutant en quelques clics.',
                image: 'https://raw.githubusercontent.com/balisama21/plateforme/main/canva.jpg',
                price: 25000,
                oldPrice: 35000,
                discount: 29,
                seller: 'Jean Dupont',
                likes: 1250,
                isTopSeller: true,
                comments: [
                    { author: 'Utilisateur Alpha', text: 'Super produit, très utile pour ma stratégie marketing !' },
                    { author: 'Designer Pro', text: 'Les modèles sont très bien conçus et faciles à modifier. Je recommande !' }
                ]
            },
            {
                id: 'product2',
                creatorId: 'user2',
                title: 'E-book : Les fondamentaux du Marketing Digital',
                category: 'E-books',
                categorySlug: 'ebook',
                description: 'Découvrez les bases essentielles du marketing digital avec cet e-book complet. Apprenez le SEO, le SEM, le marketing de contenu, les réseaux sociaux et bien plus encore pour propulser votre activité en ligne.',
                image: 'https://raw.githubusercontent.com/balisama21/plateforme/main/ebook.jpg',
                price: 15000,
                oldPrice: null,
                discount: null,
                seller: 'DigitalExpert',
                likes: 800,
                isTopSeller: false,
                comments: [
                    { author: 'Lecteur Curieux', text: 'Très instructif, j\'ai appris beaucoup de choses.' },
                    { author: 'Entrepreneur Débutant', text: 'Une excellente ressource pour commencer en marketing digital.' }
                ]
            },
            {
                id: 'product3',
                creatorId: 'user3',
                title: 'Formation complète Adobe Premiere Pro (Débutant)',
                category: 'Formations Vidéo',
                categorySlug: 'formation',
                description: 'Maîtrisez Adobe Premiere Pro du débutant à un niveau intermédiaire avec cette formation vidéo détaillée. Apprenez le montage, l\'étalonnage, l\'ajout d\'effets et l\'exportation de vos projets pour des vidéos de qualité professionnelle.',
                image: 'https://raw.githubusercontent.com/balisama21/plateforme/main/formation.jpg',
                price: 50000,
                oldPrice: 70000,
                discount: 28,
                seller: 'VideoMaestro',
                likes: 2100,
                isTopSeller: true,
                comments: [
                    { author: 'Monteur Junior', text: 'La formation est très claire et les exercices pratiques sont super !' },
                    { author: 'Apprenti Vidéaste', text: 'J\'ai enfin compris comment utiliser Premiere Pro, merci !' }
                ]
            },
            {
                id: 'product4',
                creatorId: 'user4',
                title: 'Calendrier Éditorial 2024 pour Réseaux Sociaux',
                category: 'Outils',
                categorySlug: 'outils',
                description: 'Organisez votre contenu sur les réseaux sociaux avec notre calendrier éditorial pré-rempli pour 2024. Planifiez vos publications, suivez vos performances et optimisez votre stratégie de contenu tout au long de l\'année.',
                image: 'https://raw.githubusercontent.com/balisama21/plateforme/main/calendar.jpg',
                price: 10000,
                oldPrice: null,
                discount: null,
                seller: 'ContentStrategist',
                likes: 450,
                isTopSeller: false,
                comments: [
                    { author: 'Community Manager', text: 'Indispensable pour la gestion de mes réseaux sociaux.' }
                ]
            },
            {
                id: 'product5',
                creatorId: 'user1',
                title: 'Séance de Coaching Marketing Personnalisé 1H',
                category: 'Coaching',
                categorySlug: 'coaching',
                description: 'Bénéficiez d\'une séance de coaching personnalisée d\'une heure pour discuter de votre stratégie marketing, résoudre vos défis spécifiques et obtenir des conseils d\'experts adaptés à votre entreprise.',
                image: 'https://raw.githubusercontent.com/balisama21/plateforme/main/coaching.jpg',
                price: 80000,
                oldPrice: null,
                discount: null,
                seller: 'Jean Dupont',
                likes: 320,
                isTopSeller: false,
                comments: [
                    { author: 'Client Satisfait', text: 'La séance a été très enrichissante et m\'a donné une nouvelle perspective.' }
                ]
            },
            {
                id: 'product6',
                creatorId: 'user2',
                title: '50 Modèles de Site Web Responsive (HTML/CSS)',
                category: 'Web Design',
                categorySlug: 'webdesign',
                description: 'Un ensemble de 50 modèles de sites web modernes et entièrement responsives, conçus avec HTML et CSS. Parfait pour les développeurs ou les agences souhaitant démarrer rapidement des projets professionnels.',
                image: 'https://placehold.co/600x400/98d698/ffffff?text=Modèles+Web',
                price: 30000,
                oldPrice: null,
                discount: null,
                seller: 'WebCrafters Mada',
                likes: 750,
                isTopSeller: false,
                comments: [
                    { author: 'Développeur Junior', text: 'Ces modèles sont un gain de temps incroyable. Très adaptables !' }
                ]
            },
            {
                id: 'product7',
                creatorId: 'user3',
                title: 'Outil de Gestion de Stock Simple pour PME',
                category: 'Outils',
                categorySlug: 'logistique',
                description: 'Un outil intuitif basé sur Excel (ou Google Sheets) pour les petites et moyennes entreprises. Suivez votre inventaire, gérez les entrées/sorties et optimisez vos stocks facilement.',
                image: 'https://placehold.co/600x400/add8e6/000000?text=Outil+Logistique',
                price: 20000,
                oldPrice: null,
                discount: null,
                seller: 'SolutionsEntreprise',
                likes: 300,
                isTopSeller: false,
                comments: [
                    { author: 'Gérant PME', text: 'Très pratique pour nos besoins basiques. Facile à prendre en main.' }
                ]
            }
        ];

        let currentProductId = null;

        // --- DOM ELEMENTS ---
        const mobileMenu = document.querySelector('.mobile-menu');
        const mobileNav = document.querySelector('.mobile-nav');
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.querySelector('.search-btn');
        const clearSearchBtn = document.querySelector('.clear-search-btn');
        const productsGrid = document.getElementById('productsGridSection');
        const filtersSection = document.getElementById('filtersSection');
        const allSections = document.querySelectorAll('.main > section');
        const authModal = document.getElementById('authModal');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const authLinks = document.getElementById('auth-links');
        const userProfile = document.getElementById('user-profile');
        const usernameDisplay = document.getElementById('username-display');

        // --- FUNCTIONS ---

        function toggleMobileMenu() {
            mobileMenu.classList.toggle('active');
            mobileNav.classList.toggle('active');
        }

        function showSection(sectionId) {
            allSections.forEach(section => section.classList.remove('active'));
            const sectionToShow = document.getElementById(sectionId);
            if (sectionToShow) sectionToShow.classList.add('active');

            const productsContainer = document.getElementById('productsContainer');
            const homeSection = document.getElementById('home');
            
            if (sectionId === 'home' || sectionId === 'products') {
                 if (sectionId === 'home') homeSection.classList.add('active');
                 productsContainer.classList.add('active');
                 filtersSection.classList.add('active');
                 productsGrid.classList.add('active');
                 document.getElementById('newsletterSection').classList.add('active');
                 resetSearch();
            } else {
                 productsContainer.classList.remove('active');
                 homeSection.classList.remove('active');
            }

            document.querySelectorAll('.nav-link, .mobile-nav-link').forEach(link => {
                link.classList.toggle('active', link.dataset.section === sectionId);
            });
            
            if (mobileNav.classList.contains('active')) toggleMobileMenu();
            window.scrollTo(0, 0);
        }

        function renderProductsGrid(productsToRender = products) {
            productsGrid.innerHTML = ''; 

            productsToRender.forEach(product => {
                const productCard = document.createElement('div');
                productCard.classList.add('product-card');
                productCard.dataset.id = product.id;
                productCard.dataset.category = product.categorySlug;
                productCard.dataset.isTopSeller = product.isTopSeller;
                productCard.dataset.keywords = `${product.title.toLowerCase()} ${product.category.toLowerCase()} ${product.seller.toLowerCase()}`;

                let badgeHtml = '';
                if (product.badge) { 
                    const badgeClass = product.badge === 'Nouveau' ? 'new-badge' : '';
                    badgeHtml = `<div class="product-badge ${badgeClass}">${product.badge}</div>`;
                } else if (product.discount) {
                    badgeHtml = `<div class="product-badge discount-badge">-${product.discount}%</div>`; 
                }
                
                const oldPriceHtml = product.oldPrice ? `<span class="old-price">${product.oldPrice.toLocaleString('fr-MG')} MGA</span>` : '';
                
                // NOUVEAU : Ajout des boutons modifier/supprimer
                let ownerActionsHtml = '';
                if (authState.isLoggedIn && authState.currentUser.id === product.creatorId) {
                    ownerActionsHtml = `
                        <div class="product-owner-actions">
                            <button class="edit-btn" data-action="edit">Modifier</button>
                            <button class="delete-btn" data-action="delete">Supprimer</button>
                        </div>
                    `;
                }

                productCard.innerHTML = `
                    <div class="product-image ${product.categorySlug}">
                        <img src="${product.image}" alt="${product.title}" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/333333?text=Image+non+disponible';">
                        ${badgeHtml}
                    </div>
                    <div class="product-info">
                        <div class="product-category">${product.category}</div>
                        <h3 class="product-title">${product.title}</h3>
                        <div class="product-rating">
                            <div class="stars">${'★'.repeat(Math.min(5, Math.round(product.likes / 500)) || 1)}</div>
                            <span class="rating-count">(${product.likes.toLocaleString('fr-MG')})</span>
                        </div>
                        <div class="product-price">
                            ${product.price.toLocaleString('fr-MG')} MGA
                            ${oldPriceHtml}
                        </div>
                        <div class="product-actions">
                            <button class="download-btn" data-action="download">Télécharger</button>
                            <button class="preview-btn" data-action="preview">Aperçu</button>
                        </div>
                        ${ownerActionsHtml} 
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });
        }
        
        // --- NOUVELLES FONCTIONS D'AUTHENTIFICATION ---

        function updateAuthUI() {
            if (authState.isLoggedIn) {
                authLinks.style.display = 'none';
                userProfile.style.display = 'flex';
                usernameDisplay.textContent = authState.currentUser.name;
            } else {
                authLinks.style.display = 'flex';
                userProfile.style.display = 'none';
                usernameDisplay.textContent = '';
            }
            // Re-rendre la grille pour afficher/masquer les boutons d'édition
            renderProductsGrid();
        }

        function showAuthModal(formToShow = 'login') {
            if (formToShow === 'login') {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
            } else {
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
            }
            authModal.style.display = 'block';
        }
        
        function closeAuthModal() {
            authModal.style.display = 'none';
        }
        
        function handleLogin(email, password) {
            const user = users.find(u => u.email === email && u.password === password);
            if (user) {
                authState.isLoggedIn = true;
                authState.currentUser = user;
                alert(`Bienvenue ${user.name} !`);
                closeAuthModal();
                updateAuthUI();
            } else {
                alert('Email ou mot de passe incorrect.');
            }
        }
        
        function handleRegister(name, email, password) {
            if (users.find(u => u.email === email)) {
                alert('Cet email est déjà utilisé.');
                return;
            }
            const newUser = { id: 'user' + (users.length + 1), name, email, password };
            users.push(newUser);
            authState.isLoggedIn = true;
            authState.currentUser = newUser;
            alert(`Inscription réussie ! Bienvenue ${name}.`);
            closeAuthModal();
            updateAuthUI();
        }

        function handleLogout() {
            authState.isLoggedIn = false;
            authState.currentUser = null;
            alert('Vous avez été déconnecté.');
            updateAuthUI();
            showSection('home');
        }
        
        function requireAuth(callback) {
            if (authState.isLoggedIn) {
                callback();
            } else {
                alert("Vous devez être connecté pour effectuer cette action.");
                showAuthModal('login');
            }
        }


        function performSearch() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            const searchResultsDiv = document.getElementById('searchResults');
            const searchResultsText = document.getElementById('searchResultsText');
            const searchResultsCount = document.getElementById('searchResultsCount');
            const noResultsDiv = document.getElementById('noResults');
            const loadingSpinner = document.getElementById('loadingSpinner');

            loadingSpinner.style.display = 'block';
            productsGrid.classList.remove('active');
            searchResultsDiv.classList.remove('active');
            noResultsDiv.classList.remove('active');

            setTimeout(() => { 
                loadingSpinner.style.display = 'none';
                productsGrid.classList.add('active');

                const filteredProducts = products.filter(p => {
                    const keywords = `${p.title.toLowerCase()} ${p.category.toLowerCase()} ${p.seller.toLowerCase()}`;
                    return keywords.includes(searchTerm);
                });

                renderProductsGrid(filteredProducts);
                
                if (searchTerm !== '') {
                    if (filteredProducts.length > 0) {
                        searchResultsDiv.classList.add('active');
                        searchResultsText.innerText = `Résultats de recherche pour "${searchTerm}"`;
                        searchResultsCount.innerText = `${filteredProducts.length} produit(s) trouvé(s).`;
                        noResultsDiv.classList.remove('active');
                    } else {
                        noResultsDiv.classList.add('active');
                        searchResultsDiv.classList.remove('active');
                    }
                } else {
                    resetSearch();
                }
            }, 500);
        }

        function resetSearch() {
            searchInput.value = '';
            document.getElementById('searchResults').classList.remove('active');
            document.getElementById('noResults').classList.remove('active');
            filterProducts('all');
        }

        function filterProducts(filter) {
            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.filter-btn[data-filter="${filter}"]`).classList.add('active');
            
            let filteredProducts;
            if (filter === 'all') {
                filteredProducts = products;
            } else if (filter === 'top-seller') {
                filteredProducts = products.filter(p => p.isTopSeller);
            } else {
                filteredProducts = products.filter(p => p.categorySlug === filter);
            }
            renderProductsGrid(filteredProducts);

            document.getElementById('searchResults').classList.remove('active');
            document.getElementById('noResults').classList.remove('active');
            searchInput.value = '';
        }

        function showProductDetail(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            currentProductId = productId;

            document.getElementById('detailProductTitle').innerText = product.title;
            document.getElementById('detailProductCategory').innerText = product.category;
            document.getElementById('detailProductSeller').innerText = product.seller;
            document.getElementById('detailProductPrice').innerText = `${product.price.toLocaleString('fr-MG')} MGA`;
            document.getElementById('detailProductDescription').innerText = product.description;
            document.getElementById('likeCount').innerText = product.likes.toLocaleString();

            const detailImageContainer = document.getElementById('detailProductImage');
            detailImageContainer.innerHTML = `<img src="${product.image}" alt="${product.title}">`;

            renderCommentsForProduct(product);
            showSection('productDetail');
        }

        function renderCommentsForProduct(product) {
            const commentsList = document.getElementById('commentsList');
            commentsList.innerHTML = '';
            if (product.comments && product.comments.length > 0) {
                product.comments.forEach(comment => {
                    const commentItem = document.createElement('div');
                    commentItem.classList.add('comment-item');
                    commentItem.innerHTML = `<p class="comment-author">${comment.author}</p><p class="comment-text">${comment.text}</p>`;
                    commentsList.appendChild(commentItem);
                });
                document.getElementById('commentCount').innerText = product.comments.length;
            } else {
                commentsList.innerHTML = '<p style="text-align: center; color: #666;">Aucun commentaire pour le moment.</p>';
                document.getElementById('commentCount').innerText = '0';
            }
        }
        
        // --- NOUVELLES FONCTIONS POUR MODIFIER ET SUPPRIMER ---
        function handleEditProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            // Pré-remplir le formulaire
            document.getElementById('editingProductId').value = product.id;
            document.getElementById('productTitle').value = product.title;
            document.getElementById('productCategory').value = product.categorySlug;
            document.getElementById('productDescription').value = product.description;
            document.getElementById('productPrice').value = product.price;

            // Changer le titre et le bouton du formulaire
            document.querySelector('#sellProductForm .form-title').textContent = "Modifier le produit";
            document.querySelector('#sellProductForm .form-submit-btn').textContent = "Mettre à jour";

            showSection('sellProductForm');
        }
        
        function handleDeleteProduct(productId) {
             if (confirm("Êtes-vous sûr de vouloir supprimer ce produit ? Cette action est irréversible.")) {
                const productIndex = products.findIndex(p => p.id === productId);
                if (productIndex > -1) {
                    products.splice(productIndex, 1);
                    alert("Produit supprimé avec succès.");
                    showSection('home');
                }
            }
        }


        // --- EVENT LISTENERS ---

        document.addEventListener('DOMContentLoaded', () => {
            renderProductsGrid();
            showSection('home');
            updateAuthUI(); // Mettre à jour l'UI d'authentification au chargement
        });
        
        document.querySelectorAll('.nav-link, .mobile-nav-link, .footer-section a[data-section]').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const sectionId = link.dataset.section;
                if(sectionId) showSection(sectionId);
            });
        });

        mobileMenu.addEventListener('click', toggleMobileMenu);
        document.querySelector('.mobile-nav-close').addEventListener('click', toggleMobileMenu);
        
        searchBtn.addEventListener('click', performSearch);
        searchInput.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') performSearch();
        });
        clearSearchBtn.addEventListener('click', resetSearch);

        filtersSection.addEventListener('click', (e) => {
            if (e.target.classList.contains('filter-btn')) {
                filterProducts(e.target.dataset.filter);
            }
        });
        
        productsGrid.addEventListener('click', (e) => {
            const card = e.target.closest('.product-card');
            if (!card) return;

            const action = e.target.dataset.action;
            const productId = card.dataset.id;
            
            if (action === 'download') {
                requireAuth(() => showSection('downloadForm'));
            } else if (action === 'preview') {
                showProductDetail(productId);
            } else if (action === 'edit') {
                 handleEditProduct(productId);
            } else if (action === 'delete') {
                 handleDeleteProduct(productId);
            } else { 
                showProductDetail(productId);
            }
        });

        document.getElementById('productPublishForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const editingId = document.getElementById('editingProductId').value;
            
            if (editingId) { // Mode mise à jour
                const productIndex = products.findIndex(p => p.id === editingId);
                if (productIndex > -1) {
                    products[productIndex].title = this.querySelector('#productTitle').value;
                    products[productIndex].category = this.querySelector('#productCategory').options[this.querySelector('#productCategory').selectedIndex].text;
                    products[productIndex].categorySlug = this.querySelector('#productCategory').value;
                    products[productIndex].description = this.querySelector('#productDescription').value;
                    products[productIndex].price = parseFloat(this.querySelector('#productPrice').value);
                    
                    const imageFile = this.querySelector('#productFile').files[0];
                    if (imageFile) {
                        products[productIndex].image = URL.createObjectURL(imageFile);
                    }
                    alert('Produit mis à jour !');
                }
            } else { // Mode création
                const newProduct = {
                    id: 'product' + (products.length + 1),
                    creatorId: authState.currentUser.id,
                    title: this.querySelector('#productTitle').value,
                    category: this.querySelector('#productCategory').options[this.querySelector('#productCategory').selectedIndex].text,
                    categorySlug: this.querySelector('#productCategory').value,
                    description: this.querySelector('#productDescription').value,
                    image: 'https://placehold.co/600x400/cccccc/333333?text=Nouveau+Produit',
                    price: parseFloat(this.querySelector('#productPrice').value),
                    seller: authState.currentUser.name,
                    likes: 0,
                    comments: [],
                    badge: 'Nouveau',
                    isTopSeller: false
                };
                
                const imageFile = this.querySelector('#productFile').files[0];
                if (imageFile) {
                    newProduct.image = URL.createObjectURL(imageFile);
                }

                products.unshift(newProduct);
                alert('Votre produit a été soumis !');
            }
            
            this.reset();
            document.getElementById('editingProductId').value = '';
            document.querySelector('#sellProductForm .form-title').textContent = "Proposer un nouveau produit ou service";
            document.querySelector('#sellProductForm .form-submit-btn').textContent = "Soumettre le produit";

            showSection('home');
        });
        
        document.getElementById('downloadInfoForm').addEventListener('submit', function(e){
            e.preventDefault();
            alert('Merci ! Votre téléchargement va commencer.');
            this.reset();
            showSection('home');
        });

        document.querySelector('.newsletter-form').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Merci pour votre abonnement !');
            this.reset();
        });
        
        // Page de détails (avec contrôle d'accès)
        document.getElementById('detailLikeBtn').addEventListener('click', () => {
            requireAuth(() => {
                const product = products.find(p => p.id === currentProductId);
                if (product) {
                    product.likes++;
                    document.getElementById('likeCount').innerText = product.likes.toLocaleString();
                    renderProductsGrid(); // Mettre à jour la carte dans la grille
                }
            });
        });
        
        document.getElementById('submitCommentBtn').addEventListener('click', () => {
            requireAuth(() => {
                const newCommentTextarea = document.getElementById('newCommentText');
                const newCommentContent = newCommentTextarea.value.trim();
                if (newCommentContent === '' || !currentProductId) return;

                const product = products.find(p => p.id === currentProductId);
                if (product) {
                    const newComment = { author: authState.currentUser.name, text: newCommentContent }; 
                    product.comments.push(newComment);
                    renderCommentsForProduct(product);
                    newCommentTextarea.value = '';
                }
            });
        });
        
        document.getElementById('detailDownloadBtn').addEventListener('click', () => requireAuth(() => showSection('downloadForm')));
        
        // --- EVENT LISTENERS POUR AUTHENTIFICATION ---
        document.querySelector('.header-actions').addEventListener('click', (e) => {
            const action = e.target.dataset.action;
            if (action === 'login') {
                e.preventDefault();
                showAuthModal('login');
            } else if (action === 'register') {
                e.preventDefault();
                showAuthModal('register');
            } else if (action === 'logout') {
                e.preventDefault();
                handleLogout();
            } else if (action === 'sell') {
                e.preventDefault();
                requireAuth(() => showSection('sellProductForm'));
            }
        });
        
        document.querySelector('.mobile-nav-container').addEventListener('click', (e) => {
            if (e.target.dataset.action === 'sell') {
                e.preventDefault();
                requireAuth(() => showSection('sellProductForm'));
            }
        });
        
        authModal.addEventListener('click', (e) => {
            if (e.target.classList.contains('auth-modal') || e.target.classList.contains('close-btn')) {
                closeAuthModal();
            }
            const action = e.target.dataset.action;
            if (action === 'show-register') {
                e.preventDefault();
                showAuthModal('register');
            } else if (action === 'show-login') {
                e.preventDefault();
                showAuthModal('login');
            }
        });

        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            handleLogin(email, password);
        });

        document.getElementById('registerForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            handleRegister(name, email, password);
        });

    </script>
</body>
</html>
